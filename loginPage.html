<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" type="text/css" href="/public/stylesheet.css">
	<link rel="stylesheet" type="text/css" href="/public/bulma.min.css">
    <title>Login</title>
  </head>
  <body>
    <div class="container is-centered">
    <h1>Login</h1>
    <form method="POST" action="/login">
        <div class="field">
            <p class="control has-icons-left has-icons-right">
              <input class="input" type="text" id="username" placeholder="username" required>
              <span class="icon is-small is-left">
                <i class="fas fa-envelope"></i>
              </span>
              <span class="icon is-small is-right">
                <i class="fas fa-check"></i>
              </span>
            </p>
          </div>
          <div class="field">
            <p class="control has-icons-left">
              <input class="input" type="password" placeholder="Password" id="password" required>
              <span class="icon is-small is-left">
                <i class="fas fa-lock"></i>
              </span>
            </p>
          </div>
          <div class="field">
            <p class="control">
              <button class="button is-success">
                Login
              </button>
            </p>
          </div>
            </form>
    <script>
      const form = document.querySelector('form');
form.addEventListener('submit', (event) => {
	event.preventDefault();
	const data = {
		username: form.elements.username.value,
		password: form.elements.password.value
	};
	fetch('/login', {
		method: 'POST',
		headers: {
			'Content-Type': 'application/json'
		},
		body: JSON.stringify(data)
	}).then(response => response.json()).then(data => {
		console.log(data)
		localStorage.setItem('access_token', data.access_token);

		window.location.href = "/dashboard"
	}).catch(error => console.error(error));
});
    </script>
        </div>

  </body>
</html>
